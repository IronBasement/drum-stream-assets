<local:BaseOverlayWindow x:Class="DrumStreamOverlays.SyncedLyricsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:DrumStreamOverlays"
        Title="Synced Lyrics" Width="640" Height="400">

    <Grid>
        <!-- Video Player (behind lyrics) -->
        <MediaElement Name="VideoPlayer"
                      LoadedBehavior="Manual"
                      UnloadedBehavior="Stop"
                      Stretch="Fill"
                      Volume="0"
                      Visibility="Hidden"
                      MediaEnded="VideoPlayer_MediaEnded"
                      MediaFailed="VideoPlayer_MediaFailed"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Stretch"
                      Margin="0" />

        <!-- Lyrics Container -->
        <Border Name="LyricsContainer"
                Background="#BF000000"
                CornerRadius="8"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Stretch"
                Visibility="Hidden">
            <ItemsControl Name="LyricsDisplay">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Vertical" Margin="0"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>

                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <!-- Use conditional styling within the template -->
                        <Grid>
                            <!-- Current line style -->
                            <Border Background="#7F000000"
                                    CornerRadius="8"
                                    Margin="0,4,0,4">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsCurrent}" Value="True">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <Grid Margin="8,0" HorizontalAlignment="Left">
                                    <!-- Current line text stroke (background) -->
                                    <TextBlock Text="{Binding Text}"
                                               FontFamily="Bahnschrift"
                                               FontSize="33.6"
                                               FontWeight="Bold"
                                               Foreground="Black"
                                               Padding="8"
                                               TextWrapping="Wrap">
                                        <TextBlock.Effect>
                                            <BlurEffect Radius="3"/>
                                        </TextBlock.Effect>
                                    </TextBlock>
                                    <!-- Current line main text (foreground) -->
                                    <TextBlock Text="{Binding Text}"
                                               FontFamily="Bahnschrift"
                                               FontSize="33.6"
                                               FontWeight="Bold"
                                               Foreground="White"
                                               Padding="8"
                                               TextWrapping="Wrap">
                                        <TextBlock.Effect>
                                            <DropShadowEffect Color="Black"
                                                            Direction="315"
                                                            ShadowDepth="2"
                                                            BlurRadius="1"
                                                            Opacity="0.8"/>
                                        </TextBlock.Effect>
                                    </TextBlock>
                                </Grid>
                            </Border>

                            <!-- Regular line style -->
                            <Grid Margin="8,4" HorizontalAlignment="Left">
                                <Grid.Style>
                                    <Style TargetType="Grid">
                                        <Setter Property="Visibility" Value="Visible"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsCurrent}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Grid.Style>
                                <!-- Text stroke (background) -->
                                <TextBlock Text="{Binding Text}"
                                           FontFamily="Bahnschrift"
                                           FontSize="28"
                                           FontWeight="Normal"
                                           Foreground="Black"
                                           Padding="8"
                                           TextWrapping="Wrap">
                                    <TextBlock.Effect>
                                        <BlurEffect Radius="3"/>
                                    </TextBlock.Effect>
                                </TextBlock>
                                <!-- Main text (foreground) -->
                                <TextBlock Text="{Binding Text}"
                                           FontFamily="Bahnschrift"
                                           FontSize="28"
                                           FontWeight="Normal"
                                           Foreground="#BBB092"
                                           Padding="8"
                                           TextWrapping="Wrap">
                                    <TextBlock.Effect>
                                        <DropShadowEffect Color="Black"
                                                        Direction="315"
                                                        ShadowDepth="2"
                                                        BlurRadius="1"
                                                        Opacity="0.8"/>
                                    </TextBlock.Effect>
                                </TextBlock>
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>
    </Grid>
</local:BaseOverlayWindow>
